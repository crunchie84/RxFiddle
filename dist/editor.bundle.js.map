{"version":3,"sources":["webpack:///dist/editor.bundle.js","webpack:///webpack/bootstrap 19911d4006b8129424bd?3419****","webpack:///./src/editor.ts","webpack:///external \"CodeMirror\""],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","116","getWidth","tabSize","editor","getOption","spaces","range","map","_","join","getValue","split","line","replace","length","sort","a","b","start","end","r","push","handleMessage","e","data","parent","postMessage","code","location","origin","setValue","_typeof","ranges","forEach","_ref","from","to","options","markText","lineClasses","_ref2","where","clasz","class","addLineClass","Symbol","iterator","obj","constructor","CodeMirror","scope","window","this","document","querySelector","lineNumbers","mode","addEventListener","hash","indexOf","json","atob","decodeURI","substr","JSON","parse","localStorage","getItem","on","desiredWidth","defaultCharWidth","getGutterElement","clientWidth","signal","54"],"mappings":"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","file":"./dist/editor.bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 116);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 116:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CodeMirror = __webpack_require__(54);\n__webpack_require__(54);\nvar scope = void 0;\nvar editor = void 0;\nfunction setup() {\n    scope = typeof window !== \"undefined\" ? window : this;\n    // Attach CodeMirror to the DOM \n    editor = scope.editor = CodeMirror(document.querySelector(\"#editor\"), {\n        lineNumbers: true,\n        mode: \"javascript\"\n    });\n    // Listen for messages\n    window.addEventListener(\"message\", handleMessage);\n    // Initialize with messages in uri / localStorage\n    var hash = window.location.hash;\n    if (hash.indexOf(\"blob=\") >= 0) {\n        var json = atob(decodeURI(hash.substr(hash.indexOf(\"blob=\") + \"blob=\".length)));\n        JSON.parse(json).forEach(function (data) {\n            return handleMessage({ data: data });\n        });\n    } else if (localStorage && localStorage.getItem(\"code\")) {\n        editor.setValue(localStorage.getItem(\"code\"));\n    }\n    // Dynamic behaviour\n    editor.on(\"change\", function () {\n        parent.postMessage({\n            desiredWidth: getWidth() * editor.defaultCharWidth() + editor.getGutterElement().clientWidth + 15\n        }, location.origin);\n    });\n    CodeMirror.signal(editor, \"change\");\n}\nif (typeof window !== \"undefined\") {\n    setup();\n}\n// maximum character width of editor lines\nfunction getWidth() {\n    var tabSize = editor.getOption(\"tabSize\");\n    var spaces = range(0, tabSize).map(function (_) {\n        return \"_\";\n    }).join(\"\");\n    var code = editor.getValue();\n    return code.split(\"\\n\").map(function (line) {\n        return line.replace(/\\t/g, spaces).length;\n    }).sort(function (a, b) {\n        return b - a;\n    })[0] || 0;\n}\nfunction range(start, end) {\n    var r = [];\n    for (var i = start; i < end; i++) {\n        r.push(i);\n    }\n    return r;\n}\nfunction handleMessage(e) {\n    if (e.data && e.data === \"requestCode\") {\n        parent.postMessage({ code: editor.getValue() }, location.origin);\n    }\n    if (e.data && e.data && typeof e.data.code === \"string\") {\n        if (editor.getValue() !== e.data.code) {\n            editor.setValue(e.data.code);\n        }\n    }\n    if (_typeof(e.data.ranges) === \"object\") {\n        e.data.ranges.forEach(function (_ref) {\n            var from = _ref.from,\n                to = _ref.to,\n                options = _ref.options;\n            return editor.markText(from, to, options);\n        });\n    }\n    if (_typeof(e.data.lineClasses) === \"object\") {\n        e.data.lineClasses.forEach(function (_ref2) {\n            var line = _ref2.line,\n                where = _ref2.where,\n                clasz = _ref2.class;\n            return editor.addLineClass(line, where, clasz);\n        });\n    }\n}\n\n/***/ }),\n\n/***/ 54:\n/***/ (function(module, exports) {\n\nmodule.exports = CodeMirror;\n\n/***/ })\n\n/******/ });\n\n\n// WEBPACK FOOTER //\n// dist/editor.bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 116);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 19911d4006b8129424bd","import { Doc, Editor } from \"codemirror\"\nimport * as CodeMirror from \"codemirror\"\nimport \"codemirror/mode/javascript/javascript\"\n\ndeclare type EditorDoc = Editor & Doc\ntype Pos = { line: number, ch: number }\n\nlet scope: any\nlet editor: EditorDoc\n\nfunction setup() {\n  scope = typeof window !== \"undefined\" ? window as any : this as any\n\n  // Attach CodeMirror to the DOM \n  editor = scope.editor = CodeMirror(document.querySelector(\"#editor\") as HTMLElement, {\n    lineNumbers: true,\n    mode: \"javascript\",\n  }) as EditorDoc\n\n  // Listen for messages\n  window.addEventListener(\"message\", handleMessage)\n\n  // Initialize with messages in uri / localStorage\n  let hash = window.location.hash\n  if (hash.indexOf(\"blob=\") >= 0) {\n    let json = atob(decodeURI(hash.substr(hash.indexOf(\"blob=\") + \"blob=\".length)))\n    JSON.parse(json).forEach((data: any) => handleMessage({ data }))\n  } else if (localStorage && localStorage.getItem(\"code\")) {\n    editor.setValue(localStorage.getItem(\"code\"))\n  }\n\n  // Dynamic behaviour\n  editor.on(\"change\", () => {\n    parent.postMessage({\n      desiredWidth: getWidth() * editor.defaultCharWidth() + editor.getGutterElement().clientWidth + 15,\n    }, location.origin)\n  })\n  CodeMirror.signal(editor, \"change\")\n}\n\nif (typeof window !== \"undefined\") {\n  setup()\n}\n\n// maximum character width of editor lines\nfunction getWidth(): number {\n  let tabSize = editor.getOption(\"tabSize\")\n  let spaces = range(0, tabSize).map(_ => \"_\").join(\"\")\n  let code = editor.getValue()\n  return code\n    .split(\"\\n\")\n    .map((line: string) => line.replace(/\\t/g, spaces).length)\n    .sort((a: number, b: number) => b - a)[0] || 0\n}\n\nfunction range(start: number, end: number): number[] {\n  let r = []\n  for (let i = start; i < end; i++) {\n    r.push(i)\n  }\n  return r\n}\n\nfunction handleMessage(e: any) {\n  if (e.data && e.data === \"requestCode\") {\n    parent.postMessage({ code: editor.getValue() }, location.origin)\n  }\n  if (e.data && e.data && typeof e.data.code === \"string\") {\n    if (editor.getValue() !== e.data.code) {\n      editor.setValue(e.data.code)\n    }\n  }\n  if (typeof e.data.ranges === \"object\") {\n    e.data.ranges.forEach(({ from, to, options }: { from: Pos, to: Pos, options: any }) =>\n      editor.markText(from, to, options)\n    )\n  }\n  if (typeof e.data.lineClasses === \"object\") {\n    e.data.lineClasses.forEach(({ line, where, class: clasz }: { line: number, where: string, class: string }) =>\n      editor.addLineClass(line, where, clasz)\n    )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/editor.ts","module.exports = CodeMirror;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"CodeMirror\"\n// module id = 54\n// module chunks = 5"],"sourceRoot":""}